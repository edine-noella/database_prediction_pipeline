--- Create the cropdb database
CREATE DATABASE cropdb;
USE cropdb;

-- Create the crops table
CREATE TABLE crops (crop_id INT AUTO_INCREMENT PRIMARY KEY,
name VARCHAR(255) NOT NULL UNIQUE
);

-- Create the soil_properties table
CREATE TABLE IF NOT EXISTS soils (
soil_id INT AUTO_INCREMENT PRIMARY KEY,
name VARCHAR(255) NOT NULL UNIQUE
);

-- Create the seedling_stages table
CREATE TABLE IF NOT EXISTS seedling_stages (
stage_id INT AUTO_INCREMENT PRIMARY KEY,
name VARCHAR(255) NOT NULL UNIQUE
);

--Observation table
CREATE TABLE IF NOT EXISTS observations (
observation_id INT AUTO_INCREMENT PRIMARY KEY,
crop_id INT NOT NULL,
soil_id INT NOT NULL,
stage_id INT NOT NULL,
MOI DECIMAL(8,3) NOT NULL,
temp DECIMAL(6,2) NOT NULL,
humidity DECIMAL(5,2) NOT NULL CHECK (humidity BETWEEN 0 AND 100),
result TINYINT NOT NULL,
created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
CONSTRAINT fk_obs_crop FOREIGN KEY (crop_id) REFERENCES crops(crop_id) ON DELETE RESTRICT ON UPDATE CASCADE,
CONSTRAINT fk_obs_soil FOREIGN KEY (soil_id) REFERENCES soils(soil_id) ON DELETE RESTRICT ON UPDATE CASCADE,
CONSTRAINT fk_obs_stage FOREIGN KEY (stage_id) REFERENCES seedling_stages(stage_id) ON DELETE RESTRICT ON UPDATE CASCADE
);